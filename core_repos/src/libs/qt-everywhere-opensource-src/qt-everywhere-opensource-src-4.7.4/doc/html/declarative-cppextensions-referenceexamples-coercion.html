<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- qml-extending.qdoc -->
  <title>Qt 4.7: Extending QML - Inheritance and Coercion Example</title>
  <link rel="stylesheet" type="text/css" href="style/offline.css" />
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="content"> 
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
  </div>
  <div class="breadcrumb toolblock">
    <ul>
      <li class="first"><a href="index.html">Home</a></li>
      <!--  Breadcrumbs go here -->
<li><a href="all-examples.html">Examples</a></li>
<li>QML Examples &amp; Demos</li>
<li>Extending QML - Inheritance and Coercion Example</li>
    </ul>
  </div>
</div>
<div class="content mainContent">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#declare-boy-and-girl">Declare Boy and Girl</a></li>
<li class="level2"><a href="#define-people-as-a-base-class">Define People as a base class</a></li>
<li class="level2"><a href="#define-boy-and-girl">Define Boy and Girl</a></li>
<li class="level1"><a href="#running-the-example">Running the example</a></li>
</ul>
</div>
<h1 class="title">Extending QML - Inheritance and Coercion Example</h1>
<span class="subtitle"></span>
<!-- $$$declarative/cppextensions/referenceexamples/coercion-description -->
<div class="descr"> <a name="details"></a>
<p>Files:</p>
<ul>
<li><a href="declarative-cppextensions-referenceexamples-coercion-birthdayparty-cpp.html">declarative/cppextensions/referenceexamples/coercion/birthdayparty.cpp</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-birthdayparty-h.html">declarative/cppextensions/referenceexamples/coercion/birthdayparty.h</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-example-qml.html">declarative/cppextensions/referenceexamples/coercion/example.qml</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-person-cpp.html">declarative/cppextensions/referenceexamples/coercion/person.cpp</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-person-h.html">declarative/cppextensions/referenceexamples/coercion/person.h</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-main-cpp.html">declarative/cppextensions/referenceexamples/coercion/main.cpp</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-coercion-pro.html">declarative/cppextensions/referenceexamples/coercion/coercion.pro</a></li>
<li><a href="declarative-cppextensions-referenceexamples-coercion-coercion-qrc.html">declarative/cppextensions/referenceexamples/coercion/coercion.qrc</a></li>
</ul>
<p>This example builds on:</p>
<ul>
<li><a href="declarative-cppextensions-referenceexamples-properties.html">Extending QML - Object and List Property Types Example</a></li>
<li><a href="declarative-cppextensions-referenceexamples-adding.html">Extending QML - Adding Types Example</a></li>
</ul>
<p>The Inheritance and Coercion Example shows how to use base classes to assign elements of more than one type to a property. It specializes the Person element developed in the previous examples into two elements - a <tt>Boy</tt> and a <tt>Girl</tt>.</p>
<pre class="qml"> <span class="type">BirthdayParty</span> {
     <span class="name">host</span>: <span class="name">Boy</span> {
         <span class="name">name</span>: <span class="string">&quot;Bob Jones&quot;</span>
         <span class="name">shoeSize</span>: <span class="number">12</span>
     }
     <span class="name">guests</span>: [
         <span class="type">Boy</span> { <span class="name">name</span>: <span class="string">&quot;Leo Hodges&quot;</span> },
         <span class="type">Boy</span> { <span class="name">name</span>: <span class="string">&quot;Jack Smith&quot;</span> },
         <span class="type">Girl</span> { <span class="name">name</span>: <span class="string">&quot;Anne Brown&quot;</span> }
     ]
 }</pre>
<a name="declare-boy-and-girl"></a>
<h2>Declare Boy and Girl</h2>
<pre class="cpp"> <span class="keyword">class</span> Boy : <span class="keyword">public</span> Person
 {
     Q_OBJECT
 <span class="keyword">public</span>:
     Boy(<span class="type"><a href="qobject.html">QObject</a></span> <span class="operator">*</span> parent <span class="operator">=</span> <span class="number">0</span>);
 };

 <span class="keyword">class</span> Girl : <span class="keyword">public</span> Person
 {
     Q_OBJECT
 <span class="keyword">public</span>:
     Girl(<span class="type"><a href="qobject.html">QObject</a></span> <span class="operator">*</span> parent <span class="operator">=</span> <span class="number">0</span>);
 };</pre>
<p>The Person class remains unaltered in this example and the Boy and Girl C++ classes are trivial extensions of it. As an example, the inheritance used here is a little contrived, but in real applications it is likely that the two extensions would add additional properties or modify the Person classes behavior.</p>
<a name="define-people-as-a-base-class"></a>
<h3>Define People as a base class</h3>
<p>The implementation of the People class itself has not changed since the the previous example. However, as we have repurposed the People class as a common base for Boy and Girl, we want to prevent it from being instantiated from QML directly - an explicit Boy or Girl should be instantiated instead.</p>
<pre class="cpp">     qmlRegisterType<span class="operator">&lt;</span>Person<span class="operator">&gt;</span>();</pre>
<p>While we want to disallow instantiating Person from within QML, it still needs to be registered with the QML engine, so that it can be used as a property type and other types can be coerced to it.</p>
<a name="define-boy-and-girl"></a>
<h3>Define Boy and Girl</h3>
<p>The implementation of Boy and Girl are trivial.</p>
<pre class="cpp"> Boy<span class="operator">::</span>Boy(<span class="type"><a href="qobject.html">QObject</a></span> <span class="operator">*</span> parent)
 : Person(parent)
 {
 }

 Girl<span class="operator">::</span>Girl(<span class="type"><a href="qobject.html">QObject</a></span> <span class="operator">*</span> parent)
 : Person(parent)
 {
 }</pre>
<p>All that is necessary is to implement the constructor, and to register the types and their QML name with the QML engine.</p>
<a name="running-the-example"></a>
<h2>Running the example</h2>
<p>The BirthdayParty element has not changed since the previous example. The celebrant and guests property still use the People type.</p>
<pre class="cpp">     Q_PROPERTY(Person <span class="operator">*</span>host READ host WRITE setHost)
     Q_PROPERTY(<span class="type"><a href="qdeclarativelistproperty.html">QDeclarativeListProperty</a></span><span class="operator">&lt;</span>Person<span class="operator">&gt;</span> guests READ guests)</pre>
<p>However, as all three types, Person, Boy and Girl, have been registered with the QML system, on assignment QML automatically (and type-safely) converts the Boy and Girl objects into a Person.</p>
<p>The main.cpp file in the example includes a simple shell application that loads and runs the QML snippet shown at the beginning of this page.</p>
</div>
<!-- @@@declarative/cppextensions/referenceexamples/coercion -->
  <div class="ft">
    <span></span>
  </div>
</div> 
<div class="footer">
  <p>
     <acronym title="Copyright">&copy;</acronym> 2008-2011 Nokia Corporation and/or its
     subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
     in Finland and/or other countries worldwide.</p>
  <p>
     All other trademarks are property of their respective owners. <a title="Privacy Policy"
     href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
  <br />
  <p>
    Licensees holding valid Qt Commercial licenses may use this document in accordance with the    Qt Commercial License Agreement provided with the Software or, alternatively, in accordance    with the terms contained in a written agreement between you and Nokia.</p>
  <p>
    Alternatively, this document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
    Free Documentation License version 1.3</a>
    as published by the Free Software Foundation.</p>
</div>
</body>
</html>
