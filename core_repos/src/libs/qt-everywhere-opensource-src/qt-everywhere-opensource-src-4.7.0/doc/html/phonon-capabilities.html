<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- capabilitiesexample.qdoc -->
  <title>Qt 4.7: Capabilities Example</title>
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
</head>
<body class="offline narrow creator">
 <div class="header" id="qtdocheader">
    <div class="content"> 
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
		<div id="narrowsearch"><form onsubmit="return false;" action="" id="qtdocsearch">
		<fieldset>
		<input type="text" value="" id="pageType2" name="searchstring"/>
		 </fieldset>
		</form></div>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://developer.qt.nokia.com/">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Qt 4.7</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://qt.nokia.com/doc/">ALL VERSIONS        </a></li>
      </ul>
     </div>
 <ul class="sf-menu sf-js-enabled sf-shadow" id="narrowmenu"> 
		 <li><a href="#">API Lookup</a> 
			 <ul id="topmenuLook"> 
			   <li><a href="classes.html">Class index</a></li> 
 			  <li><a href="functions.html">Function index</a></li> 
			   <li><a href="modules.html">Modules</a></li> 
			   <li><a href="namespaces.html">Namespaces</a></li> 
			   <li><a href="qtglobal.html">Global stuff</a></li> 
			   <li><a href="qdeclarativeelements.html">QML elements</a></li> 
			   </ul> 
		 </li> 
		 <li><a href="#">Qt Topics</a> 
			 <ul id="topmenuTopic"> 
			   <li><a href="qt-basic-concepts.html">Basic Qt architecture</a></li> 
			   <li><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li><a href="qt-gui-concepts.html">Desktop UI components</a></li> 
			   <li><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li><a href="best-practices.html">How-To's and Best Practices</a></li> 
			 </ul> 
		</li> 
		 <li><a href="#">Examples</a> 
			 <ul id="topmenuexample"> 
				 <li><a href="all-examples.html">Examples</a></li> 
				 <li><a href="tutorials.html">Tutorials</a></li> 
				 <li><a href="demos.html">Demos</a></li> 
				 <li><a href="qdeclarativeexamples.html">QML Examples</a></li> 
			 </ul> 
		 </li> 
 </ul> 
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="" onsubmit="return false;">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2 title="API Lookup"><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="namespaces.html">Namespaces</a></li>
              <li class="defaultLink"><a href="qtglobal.html">Global stuff</a></li>
              <li class="defaultLink"><a href="qdeclarativeelements.html">QML elements</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2 title="Qt Topics"><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
              <li class="defaultLink"><a href="qt-basic-concepts.html">Basic Qt architecture</a></li>
              <li class="defaultLink"><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li>
              <li class="defaultLink"><a href="qt-gui-concepts.html">Desktop UI components</a></li>
              <li class="defaultLink"><a href="platform-specific.html">Platform-specific info</a></li>
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2 title="Examples"><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
              <li class="defaultLink"><a href="tutorials.html">Tutorials</a></li>
              <li class="defaultLink"><a href="demos.html">Demos</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html">QML Examples</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li><a href="all-examples.html">Examples</a></li>              <li><a href="examples-phonon.html"></a></li>              <li>Capabilities Example</li>            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
          </div>
        </div>
        <div class="content">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#window-class-definition">Window Class Definition</a></li>
<li class="level1"><a href="#window-class-implementation">Window Class Implementation</a></li>
<li class="level1"><a href="#the-main-function">The main() function</a></li>
</ul>
</div>
<h1 class="title">Capabilities Example</h1>
<span class="subtitle"></span>
<!-- $$$phonon/capabilities-description -->
<div class="descr"> <a name="details"></a>
<p>Files:</p>
<ul>
<li><a href="phonon-capabilities-window-cpp.html">phonon/capabilities/window.cpp</a></li>
<li><a href="phonon-capabilities-window-h.html">phonon/capabilities/window.h</a></li>
<li><a href="phonon-capabilities-main-cpp.html">phonon/capabilities/main.cpp</a></li>
<li><a href="phonon-capabilities-capabilities-pro.html">phonon/capabilities/capabilities.pro</a></li>
</ul>
<p>The Backend Capabilities example shows how to check which MIME types, audio devices, and audio effects are available.</p>
<p class="centerAlign"><img src="images/capabilitiesexample.png" /></p><p>Phonon does not implement the multimedia functionality itself, but relies on a backend to manage this. The backends do not manage the hardware directly, but use intermediate technologies: QuickTime on Mac, GStreamer on Linux, and DirectShow (which requires DirectX) on Windows.</p>
<p>The user may add support for new MIME types and effects to these systems, and the systems abilities may also be different. The support for multimedia MIME types, and audio effects in Phonon will therefore vary from system to system.</p>
<p>Backends informs the programmer about current capabilities through an implementation of the <a href="phonon-backendcapabilities.html">Phonon::BackendCapabilities</a> namespace. The backend reports which MIME types can be played back, which audio effects are available, and which sound devices are available on the system. When the capabilities of a backend changes, it will emit the <a href="phonon-backendcapabilities-notifier.html#capabilitiesChanged">capabilitiesChanged()</a> signal.</p>
<p>The example consists of one class, <tt>Window</tt>, which displays capabilities information from the current backend used by Phonon.</p>
<p>See the Phonon Overview for a high-level introduction to Phonon.</p>
<a name="window-class-definition"></a>
<h2>Window Class Definition</h2>
<p>The <tt>Window</tt> class queries the Phonon backend for its capabilities. The results are presented in a GUI consisting of standard Qt widgets. We will now take a tour of the Phonon related parts of both the definition and implementation of the <tt>Window</tt> class.</p>
<pre class="highlightedCode brush: cpp"> private slots:
     void updateWidgets();

 private:
     void setupUi();
     void setupBackendBox();

     QGroupBox *backendBox;

     QLabel *devicesLabel;
     QLabel *mimeTypesLabel;
     QLabel *effectsLabel;

     QListWidget *mimeListWidget;
     QListView *devicesListView;
     QTreeWidget *effectsTreeWidget;</pre>
<p>We need the slot to notice changes in the backends capabilities.</p>
<p><tt>mimeListWidget</tt> and <tt>devicesListView</tt> lists MIME types and audio devices. The <tt>effectsTreeWidget</tt> lists audio effects, and expands to show their parameters.</p>
<p>The <tt>setupUi()</tt> and <tt>setupBackendBox()</tt> private utility functions create the widgets and lays them out. We skip these functions while discussing the implementation because they do not contain Phonon relevant code.</p>
<a name="window-class-implementation"></a>
<h2>Window Class Implementation</h2>
<p>Our examination starts with a look at the constructor:</p>
<pre class="highlightedCode brush: cpp"> Window::Window()
 {
     setupUi();
     updateWidgets();

     connect(Phonon::BackendCapabilities::notifier(),
             SIGNAL(capabilitiesChanged()), this, SLOT(updateWidgets()));
     connect(Phonon::BackendCapabilities::notifier(),
             SIGNAL(availableAudioOutputDevicesChanged()), SLOT(updateWidgets()));
 }</pre>
<p>After creating the user interface, we call <tt>updateWidgets()</tt>, which will fill the widgets with the information we get from the backend. We then connect the slot to the <a href="phonon-backendcapabilities-notifier.html#capabilitiesChanged">capabilitiesChanged()</a> and <a href="phonon-backendcapabilities-notifier.html#availableAudioOutputDevicesChanged">availableAudioOutputDevicesChanged()</a> signals in case the backend's abilities changes while the example is running. The signal is emitted by a <a href="phonon-backendcapabilities-notifier.html">Phonon::BackendCapabilities::Notifier</a> object, which listens for changes in the backend.</p>
<p>In the <tt>updateWidgets()</tt> function, we query the backend for information it has about its abilities and present it in the GUI of <tt>Window</tt>. We dissect it here:</p>
<pre class="highlightedCode brush: cpp"> void Window::updateWidgets()
 {
     devicesListView-&gt;setModel(new QStandardItemModel());
     Phonon::ObjectDescriptionModel&lt;Phonon::AudioOutputDeviceType&gt; *model =
             new Phonon::ObjectDescriptionModel&lt;Phonon::AudioOutputDeviceType&gt;();
     model-&gt;setModelData(Phonon::BackendCapabilities::availableAudioOutputDevices());
     devicesListView-&gt;setModel(model);</pre>
<p>The <a href="phonon-backendcapabilities-notifier.html#availableAudioOutputDevicesChanged">availableAudioOutputDevicesChanged()</a> function is a member of the <a href="phonon-backendcapabilities.html">Phonon::BackendCapabilities</a> namespace. It returns a list of <a href="phonon-objectdescription.html#AudioOutputDevice-typedef">AudioOutputDevice</a>s, which gives us information about a particular device, e.g&#x2e;, a sound card or a USB headset.</p>
<p>Note that <a href="phonon-objectdescription.html#AudioOutputDevice-typedef">AudioOutputDevice</a> and also <a href="phonon-objectdescription.html#EffectDescription-typedef">EffectDescription</a>, which is described shortly, are typedefs of <a href="phonon-objectdescription.html#ObjectDescriptionType-enum">ObjectDescriptionType</a>.</p>
<pre class="highlightedCode brush: cpp">     mimeListWidget-&gt;clear();
     QStringList mimeTypes =
             Phonon::BackendCapabilities::availableMimeTypes();
     foreach (QString mimeType, mimeTypes) {
         QListWidgetItem *item = new QListWidgetItem(mimeListWidget);
         item-&gt;setText(mimeType);
     }</pre>
<p>The MIME types supported are given as strings in a <a href="qstringlist.html">QStringList</a>. We can therefore create a list widget item with the string, and append it to the <tt>mimeListWidget</tt>, which displays the available MIME types.</p>
<pre class="highlightedCode brush: cpp">     effectsTreeWidget-&gt;clear();
     QList&lt;Phonon::EffectDescription&gt; effects =
         Phonon::BackendCapabilities::availableAudioEffects();
     foreach (Phonon::EffectDescription effect, effects) {
         QTreeWidgetItem *item = new QTreeWidgetItem(effectsTreeWidget);
         item-&gt;setText(0, tr(&quot;Effect&quot;));
         item-&gt;setText(1, effect.name());
         item-&gt;setText(2, effect.description());</pre>
<p>As before we add the description and name to our widget, which in this case is a <a href="qtreewidget.html">QTreeWidget</a>. A particular effect may also have parameters, which are inserted in the tree as child nodes of their effect.</p>
<pre class="highlightedCode brush: cpp">         Phonon::Effect *instance = new Phonon::Effect(effect, this);
         QList&lt;Phonon::EffectParameter&gt; parameters = instance-&gt;parameters();
         for (int i = 0; i &lt; parameters.size(); ++i) {
                 Phonon::EffectParameter parameter = parameters.at(i);

             QVariant defaultValue = parameter.defaultValue();
             QVariant minimumValue = parameter.minimumValue();
             QVariant maximumValue = parameter.maximumValue();

             QString valueString = QString(&quot;%1 / %2 / %3&quot;)
                     .arg(defaultValue.toString()).arg(minimumValue.toString())
                     .arg(maximumValue.toString());

             QTreeWidgetItem *parameterItem = new QTreeWidgetItem(item);
             parameterItem-&gt;setText(0, tr(&quot;Parameter&quot;));
             parameterItem-&gt;setText(1, parameter.name());
             parameterItem-&gt;setText(2, parameter.description());
             parameterItem-&gt;setText(3, QVariant::typeToName(parameter.type()));
             parameterItem-&gt;setText(4, valueString);
         }
     }</pre>
<p>The parameters are only accessible through an instance of the <a href="phonon-effect.html">Effect</a> class. Notice that an effect is created with the effect description.</p>
<p>The <a href="phonon-effectparameter.html">EffectParameter</a> contains information about one of an effects parameters. We pick out some of the information to describe the parameter in the tree widget.</p>
<a name="the-main-function"></a>
<h2>The main() function</h2>
<p>Because Phonon uses D-Bus on Linux, it is necessary to give the application a name. You do this with <a href="qcoreapplication.html#applicationName-prop">setApplicationName()</a>.</p>
<pre class="highlightedCode brush: cpp"> int main(int argv, char **args)
 {
     QApplication app(argv, args);
     app.setApplicationName(&quot;Phonon Capabilities Example&quot;);

     Window window;
     window.show();

     return app.exec();
 }</pre>
</div>
<!-- @@@phonon/capabilities -->
        <!-- /div -->
        <div class="feedback t_button">
          [+] Documentation Feedback</div>
      </div>
    </div>
    <div class="ft">
      <span></span>
    </div>
  </div> 
  <div class="footer">
    <p>
      <acronym title="Copyright">&copy;</acronym> 2008-2010 Nokia Corporation and/or its
      subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
      in Finland and/or other countries worldwide.</p>
    <p>
      All other trademarks are property of their respective owners. <a title="Privacy Policy"
        href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
  </div>
  <div id="feedbackBox">
      <div id="feedcloseX" class="feedclose t_button">X</div>
    <form id="feedform" action="http://doc.qt.nokia.com/docFeedbck/feedback.php" method="get">
      <p id="noteHead">Thank you for giving your feedback. <div class="note">Make sure it is related to this specific page. For more general bugs and 
      requests, please use the <a href="http://bugreports.qt.nokia.com/secure/Dashboard.jspa">Qt Bug Tracker</a>.</div></p>
      <p><textarea id="feedbox" name="feedText" rows="5" cols="40"></textarea></p>
      <p><input id="feedsubmit" class="feedclose" type="submit" name="feedback" /></p>
    </form>
  </div>
  <div id="blurpage">
  </div>
  <!--/div -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-4457116-5']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
