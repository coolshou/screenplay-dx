<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- combowidgetmapper.qdoc -->
  <title>Qt 4.7: Combo Widget Mapper Example</title>
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
</head>
<body class="offline narrow creator">
 <div class="header" id="qtdocheader">
    <div class="content"> 
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
		<div id="narrowsearch"><form onsubmit="return false;" action="" id="qtdocsearch">
		<fieldset>
		<input type="text" value="" id="pageType2" name="searchstring"/>
		 </fieldset>
		</form></div>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://developer.qt.nokia.com/">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Qt 4.7</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://qt.nokia.com/doc/">ALL VERSIONS        </a></li>
      </ul>
     </div>
 <ul class="sf-menu sf-js-enabled sf-shadow" id="narrowmenu"> 
		 <li><a href="#">API Lookup</a> 
			 <ul id="topmenuLook"> 
			   <li><a href="classes.html">Class index</a></li> 
 			  <li><a href="functions.html">Function index</a></li> 
			   <li><a href="modules.html">Modules</a></li> 
			   <li><a href="namespaces.html">Namespaces</a></li> 
			   <li><a href="qtglobal.html">Global stuff</a></li> 
			   <li><a href="qdeclarativeelements.html">QML elements</a></li> 
			   </ul> 
		 </li> 
		 <li><a href="#">Qt Topics</a> 
			 <ul id="topmenuTopic"> 
			   <li><a href="qt-basic-concepts.html">Basic Qt architecture</a></li> 
			   <li><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li><a href="qt-gui-concepts.html">Desktop UI components</a></li> 
			   <li><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li><a href="best-practices.html">How-To's and Best Practices</a></li> 
			 </ul> 
		</li> 
		 <li><a href="#">Examples</a> 
			 <ul id="topmenuexample"> 
				 <li><a href="all-examples.html">Examples</a></li> 
				 <li><a href="tutorials.html">Tutorials</a></li> 
				 <li><a href="demos.html">Demos</a></li> 
				 <li><a href="qdeclarativeexamples.html">QML Examples</a></li> 
			 </ul> 
		 </li> 
 </ul> 
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="" onsubmit="return false;">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2 title="API Lookup"><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="namespaces.html">Namespaces</a></li>
              <li class="defaultLink"><a href="qtglobal.html">Global stuff</a></li>
              <li class="defaultLink"><a href="qdeclarativeelements.html">QML elements</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2 title="Qt Topics"><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
              <li class="defaultLink"><a href="qt-basic-concepts.html">Basic Qt architecture</a></li>
              <li class="defaultLink"><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li>
              <li class="defaultLink"><a href="qt-gui-concepts.html">Desktop UI components</a></li>
              <li class="defaultLink"><a href="platform-specific.html">Platform-specific info</a></li>
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2 title="Examples"><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
              <li class="defaultLink"><a href="tutorials.html">Tutorials</a></li>
              <li class="defaultLink"><a href="demos.html">Demos</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html">QML Examples</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li><a href="all-examples.html">Examples</a></li>              <li><a href="examples-itemviews.html">Item Views Examples</a></li>              <li>Combo Widget Mapper Example</li>            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
          </div>
        </div>
        <div class="content">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#window-class-definition">Window Class Definition</a></li>
<li class="level1"><a href="#window-class-implementation">Window Class Implementation</a></li>
<li class="level1"><a href="#summary-and-further-reading">Summary and Further Reading</a></li>
</ul>
</div>
<h1 class="title">Combo Widget Mapper Example</h1>
<span class="subtitle"></span>
<!-- $$$itemviews/combowidgetmapper-description -->
<div class="descr"> <a name="details"></a>
<p>Files:</p>
<ul>
<li><a href="itemviews-combowidgetmapper-window-cpp.html">itemviews/combowidgetmapper/window.cpp</a></li>
<li><a href="itemviews-combowidgetmapper-window-h.html">itemviews/combowidgetmapper/window.h</a></li>
<li><a href="itemviews-combowidgetmapper-main-cpp.html">itemviews/combowidgetmapper/main.cpp</a></li>
<li><a href="itemviews-combowidgetmapper-combowidgetmapper-pro.html">itemviews/combowidgetmapper/combowidgetmapper.pro</a></li>
</ul>
<p>The Delegate Widget Mapper example shows how to use a custom delegate to map information from a model to specific widgets on a form.</p>
<p class="centerAlign"><img src="images/combo-widget-mapper.png" /></p><p>In the <a href="itemviews-simplewidgetmapper.html">Simple Widget Mapper Example</a>, we showed the basic use of a widget mapper to relate data exposed by a model to simple input widgets in a user interface. However, sometimes we want to use input widgets that expose data as choices to the user, such as <a href="qcombobox.html">QComboBox</a>, and we need a way to relate their input to the values stored in the model.</p>
<p>This example is very similar to the <a href="itemviews-simplewidgetmapper.html">Simple Widget Mapper Example</a>. Again, we create a <tt>Window</tt> class with an almost identical user interface, except that, instead of providing a spin box so that each person's age can be entered, we provide a combo box to allow their addresses to be classified as &quot;Home&quot;, &quot;Work&quot; or &quot;Other&quot;.</p>
<a name="window-class-definition"></a>
<h2>Window Class Definition</h2>
<p>The class provides a constructor, a slot to keep the buttons up to date, and a private function to set up the model:</p>
<pre class="highlightedCode brush: cpp"> class Window : public QWidget
 {
     Q_OBJECT

 public:
     Window(QWidget *parent = 0);

 private slots:
     void updateButtons(int row);

 private:
     void setupModel();

     QLabel *nameLabel;
     QLabel *addressLabel;
     QLabel *typeLabel;
     QLineEdit *nameEdit;
     QTextEdit *addressEdit;
     QComboBox *typeComboBox;
     QPushButton *nextButton;
     QPushButton *previousButton;

     QStandardItemModel *model;
     QStringListModel *typeModel;
     QDataWidgetMapper *mapper;
 };</pre>
<p>In addition to the <a href="qdatawidgetmapper.html">QDataWidgetMapper</a> object and the controls used to make up the user interface, we use a <a href="qstandarditemmodel.html">QStandardItemModel</a> to hold our data and a <a href="qstringlistmodel.html">QStringListModel</a> to hold information about the types of address that can be applied to each person's data.</p>
<a name="window-class-implementation"></a>
<h2>Window Class Implementation</h2>
<p>The constructor of the <tt>Window</tt> class can be explained in three parts. In the first part, we set up the widgets used for the user interface:</p>
<pre class="highlightedCode brush: cpp"> Window::Window(QWidget *parent)
     : QWidget(parent)
 {
     setupModel();

     nameLabel = new QLabel(tr(&quot;Na&amp;me:&quot;));
     nameEdit = new QLineEdit();
     addressLabel = new QLabel(tr(&quot;&amp;Address:&quot;));
     addressEdit = new QTextEdit();
     typeLabel = new QLabel(tr(&quot;&amp;Type:&quot;));
     typeComboBox = new QComboBox();
     nextButton = new QPushButton(tr(&quot;&amp;Next&quot;));
     previousButton = new QPushButton(tr(&quot;&amp;Previous&quot;));

     nameLabel-&gt;setBuddy(nameEdit);
     addressLabel-&gt;setBuddy(addressEdit);
     typeLabel-&gt;setBuddy(typeComboBox);

     typeComboBox-&gt;setModel(typeModel);</pre>
<p>Note that we set up the mapping the combo box in the same way as for other widgets, but that we apply its own model to it so that it will display data from its own model, the <tt>typeModel</tt>, rather than from the model containing data about each person.</p>
<p>Next, we set up the widget mapper, relating each input widget to a column in the model specified by the call to <a href="qdatawidgetmapper.html#setModel">setModel()</a>:</p>
<pre class="highlightedCode brush: cpp">     mapper = new QDataWidgetMapper(this);
     mapper-&gt;setModel(model);
     mapper-&gt;addMapping(nameEdit, 0);
     mapper-&gt;addMapping(addressEdit, 1);
     mapper-&gt;addMapping(typeComboBox, 2, &quot;currentIndex&quot;);</pre>
<p>For the combo box, we pass an extra argument to tell the widget mapper which property to relate to values from the model. As a result, the user is able to select an item from the combo box, and the corresponding value stored in the widget's <tt>currentIndex</tt> property will be stored in the model.</p>
<p>The rest of the constructor is very similar to that of the <a href="itemviews-simplewidgetmapper.html">Simple Widget Mapper Example</a>:</p>
<pre class="highlightedCode brush: cpp">     connect(previousButton, SIGNAL(clicked()),
             mapper, SLOT(toPrevious()));
     connect(nextButton, SIGNAL(clicked()),
             mapper, SLOT(toNext()));
     connect(mapper, SIGNAL(currentIndexChanged(int)),
             this, SLOT(updateButtons(int)));

     QGridLayout *layout = new QGridLayout();
     layout-&gt;addWidget(nameLabel, 0, 0, 1, 1);
     layout-&gt;addWidget(nameEdit, 0, 1, 1, 1);
     layout-&gt;addWidget(previousButton, 0, 2, 1, 1);
     layout-&gt;addWidget(addressLabel, 1, 0, 1, 1);
     layout-&gt;addWidget(addressEdit, 1, 1, 2, 1);
     layout-&gt;addWidget(nextButton, 1, 2, 1, 1);
     layout-&gt;addWidget(typeLabel, 3, 0, 1, 1);
     layout-&gt;addWidget(typeComboBox, 3, 1, 1, 1);
     setLayout(layout);

     setWindowTitle(tr(&quot;Delegate Widget Mapper&quot;));
     mapper-&gt;toFirst();
 }</pre>
<p>The model is initialized in the window's <tt>setupModel()</tt> function. Here, we create a standard model with 5 rows and 3 columns. In each row, we insert a name, address, and a value that indicates the type of address. The address types are stored in a string list model.</p>
<pre class="highlightedCode brush: cpp"> void Window::setupModel()
 {
     QStringList items;
     items &lt;&lt; tr(&quot;Home&quot;) &lt;&lt; tr(&quot;Work&quot;) &lt;&lt; tr(&quot;Other&quot;);
     typeModel = new QStringListModel(items, this);

     model = new QStandardItemModel(5, 3, this);
     QStringList names;
     names &lt;&lt; &quot;Alice&quot; &lt;&lt; &quot;Bob&quot; &lt;&lt; &quot;Carol&quot; &lt;&lt; &quot;Donald&quot; &lt;&lt; &quot;Emma&quot;;
     QStringList addresses;
     addresses &lt;&lt; &quot;&lt;qt&gt;123 Main Street&lt;br/&gt;Market Town&lt;/qt&gt;&quot;
               &lt;&lt; &quot;&lt;qt&gt;PO Box 32&lt;br/&gt;Mail Handling Service&quot;
                  &quot;&lt;br/&gt;Service City&lt;/qt&gt;&quot;
               &lt;&lt; &quot;&lt;qt&gt;The Lighthouse&lt;br/&gt;Remote Island&lt;/qt&gt;&quot;
               &lt;&lt; &quot;&lt;qt&gt;47338 Park Avenue&lt;br/&gt;Big City&lt;/qt&gt;&quot;
               &lt;&lt; &quot;&lt;qt&gt;Research Station&lt;br/&gt;Base Camp&lt;br/&gt;Big Mountain&lt;/qt&gt;&quot;;

     QStringList types;
     types &lt;&lt; &quot;0&quot; &lt;&lt; &quot;1&quot; &lt;&lt; &quot;2&quot; &lt;&lt; &quot;0&quot; &lt;&lt; &quot;2&quot;;

     for (int row = 0; row &lt; 5; ++row) {
       QStandardItem *item = new QStandardItem(names[row]);
       model-&gt;setItem(row, 0, item);
       item = new QStandardItem(addresses[row]);
       model-&gt;setItem(row, 1, item);
       item = new QStandardItem(types[row]);
       model-&gt;setItem(row, 2, item);
     }
 }</pre>
<p>As we insert each row into the model, like a record in a database, we store values that correspond to items in <tt>typeModel</tt> for each person's address type. When the widget mapper reads these values from the final column of each row, it will need to use them as references to values in <tt>typeModel</tt>, as shown in the following diagram. This is where the delegate is used.</p>
<p class="centerAlign"><img src="images/widgetmapper-combo-mapping.png" /></p><p>We show the implementation of the <tt>updateButtons()</tt> slot for completeness:</p>
<pre class="highlightedCode brush: cpp"> void Window::updateButtons(int row)
 {
     previousButton-&gt;setEnabled(row &gt; 0);
     nextButton-&gt;setEnabled(row &lt; model-&gt;rowCount() - 1);
 }</pre>
<a name="summary-and-further-reading"></a>
<h2>Summary and Further Reading</h2>
<p>The use of a separate model for the combo box provides a menu of choices that are separate from the data stored in the main model. Using a named mapping that relates the combo box's <tt>currentIndex</tt> property to a column in the model effectively allows us to store a look-up value in the model.</p>
<p>However, when reading the model outside the context of the widget mapper, we need to know about the <tt>typeModel</tt> to make sense of these look-up values. It would be useful to be able to store both the data and the choices held by the <tt>typeModel</tt> in one place. This is covered by the <a href="sql-sqlwidgetmapper.html">SQL Widget Mapper Example</a>.</p>
</div>
<!-- @@@itemviews/combowidgetmapper -->
        <!-- /div -->
        <div class="feedback t_button">
          [+] Documentation Feedback</div>
      </div>
    </div>
    <div class="ft">
      <span></span>
    </div>
  </div> 
  <div class="footer">
    <p>
      <acronym title="Copyright">&copy;</acronym> 2008-2010 Nokia Corporation and/or its
      subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
      in Finland and/or other countries worldwide.</p>
    <p>
      All other trademarks are property of their respective owners. <a title="Privacy Policy"
        href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
  </div>
  <div id="feedbackBox">
      <div id="feedcloseX" class="feedclose t_button">X</div>
    <form id="feedform" action="http://doc.qt.nokia.com/docFeedbck/feedback.php" method="get">
      <p id="noteHead">Thank you for giving your feedback. <div class="note">Make sure it is related to this specific page. For more general bugs and 
      requests, please use the <a href="http://bugreports.qt.nokia.com/secure/Dashboard.jspa">Qt Bug Tracker</a>.</div></p>
      <p><textarea id="feedbox" name="feedText" rows="5" cols="40"></textarea></p>
      <p><input id="feedsubmit" class="feedclose" type="submit" name="feedback" /></p>
    </form>
  </div>
  <div id="blurpage">
  </div>
  <!--/div -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-4457116-5']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
