<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- webbrowser.qdoc -->
  <title>Qt 4.7: Web Browser Example (ActiveQt)</title>
  <link rel="stylesheet" type="text/css" href="style/offline.css" />
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="content"> 
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
  </div>
  <div class="breadcrumb toolblock">
    <ul>
      <li class="first"><a href="index.html">Home</a></li>
      <!--  Breadcrumbs go here -->
<li><a href="all-examples.html">Examples</a></li>
<li>Web Browser Example (ActiveQt)</li>
    </ul>
  </div>
</div>
<div class="content mainContent">
<h1 class="title">Web Browser Example (ActiveQt)</h1>
<span class="subtitle"></span>
<!-- $$$activeqt/webbrowser-description -->
<div class="descr"> <a name="details"></a>
<p>Files:</p>
<ul>
<li><a href="activeqt-webbrowser-mainwindow-ui.html">activeqt/webbrowser/mainwindow.ui</a></li>
<li><a href="activeqt-webbrowser-mainwindow-windowsmobile-ui.html">activeqt/webbrowser/mainwindow_windowsmobile.ui</a></li>
<li><a href="activeqt-webbrowser-webaxwidget-h.html">activeqt/webbrowser/webaxwidget.h</a></li>
<li><a href="activeqt-webbrowser-main-cpp.html">activeqt/webbrowser/main.cpp</a></li>
<li><a href="activeqt-webbrowser-webbrowser-pro.html">activeqt/webbrowser/webbrowser.pro</a></li>
</ul>
<p>The Web Browser example uses the Microsoft Web Browser ActiveX control to implement a fully functional Web Browser application. The user interface has been developed using the Qt Designer integration of the <a href="qaxwidget.html">QAxWidget</a> class.</p>
<p>The code demonstrates how the Qt application can communicate with the embedded ActiveX controls using signals, slots and the dynamicCall() function.</p>
<pre class="cpp"> <span class="keyword">class</span> MainWindow : <span class="keyword">public</span> <span class="type"><a href="qmainwindow.html">QMainWindow</a></span><span class="operator">,</span> <span class="keyword">public</span> Ui<span class="operator">::</span>MainWindow
 {
     Q_OBJECT
 <span class="keyword">public</span>:
     MainWindow();

 <span class="keyword">public</span> <span class="keyword">slots</span>:
     <span class="type">void</span> on_WebBrowser_TitleChange(<span class="keyword">const</span> <span class="type"><a href="qstring.html">QString</a></span> <span class="operator">&amp;</span>title);
     <span class="type">void</span> on_WebBrowser_ProgressChange(<span class="type">int</span> a<span class="operator">,</span> <span class="type">int</span> b);
     <span class="type">void</span> on_WebBrowser_CommandStateChange(<span class="type">int</span> cmd<span class="operator">,</span> <span class="type">bool</span> on);
     <span class="type">void</span> on_WebBrowser_BeforeNavigate();
     <span class="type">void</span> on_WebBrowser_NavigateComplete(<span class="type"><a href="qstring.html">QString</a></span>);

     <span class="type">void</span> on_actionGo_triggered();
     <span class="type">void</span> on_actionNewWindow_triggered();
     <span class="type">void</span> on_actionAbout_triggered();
     <span class="type">void</span> on_actionAboutQt_triggered();
     <span class="type">void</span> on_actionFileClose_triggered();

 <span class="keyword">private</span>:
     <span class="type"><a href="qprogressbar.html">QProgressBar</a></span> <span class="operator">*</span>pb;
 };</pre>
<p>The <tt>MainWindow</tt> class declares a <tt>QMainWindow</tt> based user interface, using the <tt>Ui::MainWindow</tt> class generated by Qt Designer. A number of slots are implemented to handle events from the various user interface elements, including the <tt>WebBrowser</tt> object, which is a <a href="qaxwidget.html">QAxWidget</a> hosting the Microsoft Web Browser control.</p>
<pre class="cpp"> MainWindow<span class="operator">::</span>MainWindow()
 {
     setupUi(<span class="keyword">this</span>);

     connect(addressEdit<span class="operator">,</span> SIGNAL(returnPressed())<span class="operator">,</span> actionGo<span class="operator">,</span> SLOT(trigger()));
     connect(actionBack<span class="operator">,</span> SIGNAL(triggered())<span class="operator">,</span> WebBrowser<span class="operator">,</span> SLOT(GoBack()));
     connect(actionForward<span class="operator">,</span> SIGNAL(triggered())<span class="operator">,</span> WebBrowser<span class="operator">,</span> SLOT(GoForward()));
     connect(actionStop<span class="operator">,</span> SIGNAL(triggered())<span class="operator">,</span> WebBrowser<span class="operator">,</span> SLOT(Stop()));
     connect(actionRefresh<span class="operator">,</span> SIGNAL(triggered())<span class="operator">,</span> WebBrowser<span class="operator">,</span> SLOT(Refresh()));
     connect(actionHome<span class="operator">,</span> SIGNAL(triggered())<span class="operator">,</span> WebBrowser<span class="operator">,</span> SLOT(GoHome()));
     connect(actionSearch<span class="operator">,</span> SIGNAL(triggered())<span class="operator">,</span> WebBrowser<span class="operator">,</span> SLOT(GoSearch()));

     pb <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="qprogressbar.html">QProgressBar</a></span>(statusBar());
     pb<span class="operator">-</span><span class="operator">&gt;</span>setTextVisible(<span class="keyword">false</span>);
     pb<span class="operator">-</span><span class="operator">&gt;</span>hide();
     statusBar()<span class="operator">-</span><span class="operator">&gt;</span>addPermanentWidget(pb);

     WebBrowser<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">&quot;GoHome()&quot;</span>);
 }</pre>
<p>The constructor initializes the user interface, installs a progress bar on the status bar, and uses <a href="qaxbase.html#dynamicCall">QAxBase::dynamicCall</a>() to invoke the <tt>GoHome()</tt> method of Internet Explorer to navigate to the user's home page.</p>
<pre class="cpp"> <span class="type">void</span> MainWindow<span class="operator">::</span>on_WebBrowser_TitleChange(<span class="keyword">const</span> <span class="type"><a href="qstring.html">QString</a></span> <span class="operator">&amp;</span>title)
 {
     setWindowTitle(<span class="string">&quot;Qt WebBrowser - &quot;</span> <span class="operator">+</span> title);
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_WebBrowser_ProgressChange(<span class="type">int</span> a<span class="operator">,</span> <span class="type">int</span> b)
 {
     <span class="keyword">if</span> (a <span class="operator">&lt;</span><span class="operator">=</span> <span class="number">0</span> <span class="operator">|</span><span class="operator">|</span> b <span class="operator">&lt;</span><span class="operator">=</span> <span class="number">0</span>) {
         pb<span class="operator">-</span><span class="operator">&gt;</span>hide();
         <span class="keyword">return</span>;
     }
     pb<span class="operator">-</span><span class="operator">&gt;</span>show();
     pb<span class="operator">-</span><span class="operator">&gt;</span>setRange(<span class="number">0</span><span class="operator">,</span> b);
     pb<span class="operator">-</span><span class="operator">&gt;</span>setValue(a);
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_WebBrowser_CommandStateChange(<span class="type">int</span> cmd<span class="operator">,</span> <span class="type">bool</span> on)
 {
     <span class="keyword">switch</span> (cmd) {
     <span class="keyword">case</span> <span class="number">1</span>:
         actionForward<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(on);
         <span class="keyword">break</span>;
     <span class="keyword">case</span> <span class="number">2</span>:
         actionBack<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(on);
         <span class="keyword">break</span>;
     }
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_WebBrowser_BeforeNavigate()
 {
     actionStop<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">true</span>);
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_WebBrowser_NavigateComplete(<span class="type"><a href="qstring.html">QString</a></span>)
 {
     actionStop<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
 }</pre>
<p>Different slots handle the signals emitted by the WebBrowser object.</p>
<p>Connections that don't require any coding, i.e&#x2e; connecting the <tt>back</tt> action to the <tt>GoBack()</tt> slot, have already been made in Qt Designer.</p>
<pre class="cpp"> <span class="type">void</span> MainWindow<span class="operator">::</span>on_actionGo_triggered()
 {
     WebBrowser<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">&quot;Navigate(const QString&amp;)&quot;</span><span class="operator">,</span> addressEdit<span class="operator">-</span><span class="operator">&gt;</span>text());
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_actionNewWindow_triggered()
 {
     MainWindow <span class="operator">*</span>window <span class="operator">=</span> <span class="keyword">new</span> MainWindow;
     window<span class="operator">-</span><span class="operator">&gt;</span>show();
     <span class="keyword">if</span> (addressEdit<span class="operator">-</span><span class="operator">&gt;</span>text()<span class="operator">.</span>isEmpty())
         <span class="keyword">return</span>;
     window<span class="operator">-</span><span class="operator">&gt;</span>addressEdit<span class="operator">-</span><span class="operator">&gt;</span>setText(addressEdit<span class="operator">-</span><span class="operator">&gt;</span>text());
     window<span class="operator">-</span><span class="operator">&gt;</span>actionStop<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">true</span>);
     window<span class="operator">-</span><span class="operator">&gt;</span>on_actionGo_triggered();
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_actionAbout_triggered()
 {
     <span class="type"><a href="qmessagebox.html">QMessageBox</a></span><span class="operator">::</span>about(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">&quot;About WebBrowser&quot;</span>)<span class="operator">,</span>
                 tr(<span class="string">&quot;This Example has been created using the ActiveQt integration into Qt Designer.\n&quot;</span>
                    <span class="string">&quot;It demonstrates the use of QAxWidget to embed the Internet Explorer ActiveX\n&quot;</span>
                    <span class="string">&quot;control into a Qt application.&quot;</span>));
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_actionAboutQt_triggered()
 {
     <span class="type"><a href="qmessagebox.html">QMessageBox</a></span><span class="operator">::</span>aboutQt(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">&quot;About Qt&quot;</span>));
 }

 <span class="type">void</span> MainWindow<span class="operator">::</span>on_actionFileClose_triggered()
 {
     close();
 }

 <span class="preprocessor">#include &quot;main.moc&quot;</span>

 <span class="type">int</span> main(<span class="type">int</span> argc<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span><span class="operator">*</span> argv)
 {
     <span class="type"><a href="qapplication.html">QApplication</a></span> a(argc<span class="operator">,</span> argv);
     MainWindow w;
 <span class="preprocessor">#if defined(Q_OS_WINCE)</span>
     w<span class="operator">.</span>showMaximized();
 <span class="preprocessor">#else</span>
     w<span class="operator">.</span>show();
 <span class="preprocessor">#endif</span>
     <span class="keyword">return</span> a<span class="operator">.</span>exec();
 }</pre>
<p>The rest of the implementation is not related to <a href="activeqt.html#activeqt">ActiveQt</a> - the actions are handled by different slots, and the entry point function starts the application using standard Qt APIs.</p>
<p>To build the example you must first build the <a href="qaxcontainer.html">QAxContainer</a> library. Then run your make tool in <tt>examples/activeqt/webbrowser</tt> and run the resulting <tt>webbrowser.exe</tt>.</p>
</div>
<!-- @@@activeqt/webbrowser -->
  <div class="ft">
    <span></span>
  </div>
</div> 
<div class="footer">
  <p>
     <acronym title="Copyright">&copy;</acronym> 2008-2011 Nokia Corporation and/or its
     subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
     in Finland and/or other countries worldwide.</p>
  <p>
     All other trademarks are property of their respective owners. <a title="Privacy Policy"
     href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
  <br />
  <p>
    Licensees holding valid Qt Commercial licenses may use this document in accordance with the    Qt Commercial License Agreement provided with the Software or, alternatively, in accordance    with the terms contained in a written agreement between you and Nokia.</p>
  <p>
    Alternatively, this document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
    Free Documentation License version 1.3</a>
    as published by the Free Software Foundation.</p>
</div>
</body>
</html>
